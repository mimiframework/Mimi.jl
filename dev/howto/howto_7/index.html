<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>7 Port to v0.5.0 · Mimi.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Mimi.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/tutorial_main/">Tutorials Intro</a></li><li><a class="tocitem" href="../../tutorials/tutorial_1/">1 Install Mimi</a></li><li><a class="tocitem" href="../../tutorials/tutorial_2/">2 Run an Existing Model</a></li><li><a class="tocitem" href="../../tutorials/tutorial_3/">3 Modify an Existing Model</a></li><li><a class="tocitem" href="../../tutorials/tutorial_4/">4 Create a Model</a></li><li><a class="tocitem" href="../../tutorials/tutorial_5/">5 Monte Carlo + Sensitivity Analysis</a></li><li><a class="tocitem" href="../../tutorials/tutorial_6/">6 Create a Model with Composite Components</a></li></ul></li><li><span class="tocitem">How-to Guides</span><ul><li><a class="tocitem" href="../howto_main/">How-to Guides Intro</a></li><li><a class="tocitem" href="../howto_1/">1 Construct + Run a Model</a></li><li><a class="tocitem" href="../howto_2/">2 Explore Results</a></li><li><a class="tocitem" href="../howto_3/">3 Monte Carlo + SA</a></li><li><a class="tocitem" href="../howto_4/">4 Timesteps</a></li><li><a class="tocitem" href="../howto_5/">5 Parameters + Variables</a></li><li><a class="tocitem" href="../howto_6/">6 Update Time Dimension</a></li><li class="is-active"><a class="tocitem" href>7 Port to v0.5.0</a><ul class="internal"><li><a class="tocitem" href="#Defining-Components-1"><span>Defining Components</span></a></li><li><a class="tocitem" href="#Constructing-a-Model-1"><span>Constructing a Model</span></a></li><li><a class="tocitem" href="#Running-a-Model-1"><span>Running a Model</span></a></li><li><a class="tocitem" href="#Accessing-Results-1"><span>Accessing Results</span></a></li><li><a class="tocitem" href="#Plotting-and-the-Explorer-UI-1"><span>Plotting and the Explorer UI</span></a></li><li><a class="tocitem" href="#Advanced-Topics-1"><span>Advanced Topics</span></a></li></ul></li><li><a class="tocitem" href="../howto_8/">8 Port to v1.0.0</a></li><li><a class="tocitem" href="../howto_9/">9 Port to New Param API</a></li></ul></li><li><span class="tocitem">Advanced How-to Guides</span><ul><li><a class="tocitem" href="../../howto_advanced/howto_adv_main/">Advanced How-to Guides Intro</a></li><li><a class="tocitem" href="../../howto_advanced/howto_adv_buildinit/">Build and Init Functions</a></li><li><a class="tocitem" href="../../howto_advanced/howto_adv_datumrefs/">Using Datum References</a></li></ul></li><li><span class="tocitem">Reference Guides</span><ul><li><a class="tocitem" href="../../ref/ref_main/">Reference Guides Intro</a></li><li><a class="tocitem" href="../../ref/ref_API/">Mimi API</a></li><li><a class="tocitem" href="../../ref/ref_structures_classes_types/">Structures: Classes.jl and Types</a></li><li><a class="tocitem" href="../../ref/ref_structures_definitions/">Structures: Definitions</a></li><li><a class="tocitem" href="../../ref/ref_structures_instances/">Structures: Instances</a></li></ul></li><li><span class="tocitem">Explanations</span><ul><li><a class="tocitem" href="../../explanations/exp_main/">Explanations Intro</a></li><li><a class="tocitem" href="../../explanations/exp_pkgs/">Models as Packages</a></li></ul></li><li><a class="tocitem" href="../../faq/">FAQ</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">How-to Guides</a></li><li class="is-active"><a href>7 Port to v0.5.0</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>7 Port to v0.5.0</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mimiframework/Mimi.jl/blob/master/docs/src/howto/howto_7.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="How-to-Guide-7:-Port-to-Mimi-v0.5.0-1"><a class="docs-heading-anchor" href="#How-to-Guide-7:-Port-to-Mimi-v0.5.0-1">How-to Guide 7: Port to Mimi v0.5.0</a><a class="docs-heading-anchor-permalink" href="#How-to-Guide-7:-Port-to-Mimi-v0.5.0-1" title="Permalink"></a></h1><p>The release of Mimi v0.5.0 is a breaking release, necessitating the adaptation of existing models&#39; syntax and structure in order for those models to run on this new version.  This guide provides an overview of the steps required to get most models using the v0.4.0 API working with v0.5.0.  It is <strong>not</strong> a comprehensive review of all changes and new functionalities, but a guide to the minimum steps required to port old models between versions.  For complete information on the new version and its functionalities, see the full documentation.</p><p>This guide is organized into six main sections, each describing an independent set of changes that can be undertaken in any order desired.  </p><ol><li>Defining components</li><li>Constructing a model</li><li>Running the model</li><li>Accessing results</li><li>Plotting</li><li>Advanced topics</li></ol><p><strong>A Note on Function Naming</strong>: There has been a general overhaul on function names, especially those in the explicitly user-facing API, to be consistent with Julia conventions and the conventions of this Package.  These can be briefly summarized as follows:</p><ul><li>use <code>_</code> for readability</li><li>append all functions with side-effects, i.e., non-pure functions that return a value but leave all else unchanged with a <code>!</code></li><li>the commonly used terms <code>component</code>, <code>variable</code>, and <code>parameter</code> are shortened to <code>comp</code>, <code>var</code>, and <code>param</code></li><li>functions that act upon a <code>component</code>, <code>variable</code>, or <code>parameter</code> are often written in the form <code>[action]_[comp/var/param]</code></li></ul><h2 id="Defining-Components-1"><a class="docs-heading-anchor" href="#Defining-Components-1">Defining Components</a><a class="docs-heading-anchor-permalink" href="#Defining-Components-1" title="Permalink"></a></h2><p>The <code>run_timestep</code> function is now contained by the <code>@defcomp</code> macro, and takes the parameters <code>p, v, d, t</code>, referring to Parameters, Variables, and Dimensions of the component you defined.  The fourth argument is an <code>AbstractTimestep</code>, i.e., either a <code>FixedTimestep</code> or a <code>VariableTimestep</code>.  Similarly, the optional <code>init</code> function is also contained by <code>@defcomp</code>, and takes the parameters <code>p, v, d</code>.  Thus, as described in the user guide, defining a single component is now done as follows:</p><p>In this version, the fourth argument (<code>t</code> below) can no longer always be used simply as an <code>Int</code>. Indexing with <code>t</code> is still permitted, but special care must be taken when comparing <code>t</code> with conditionals or using it in arithmetic expressions.  The full API as described later in this document in <strong>Advanced Topics:  Timesteps and available functions</strong>.  Since differential equations are commonly used as the basis for these models&#39; equations, the most commonly needed change will be changing <code>if t == 1</code> to <code>if is_first(t)</code></p><pre><code class="language-julia">@defcomp component1 begin

    # First define the state this component will hold
    savingsrate = Parameter()

    # Second, define the (optional) init function for the component
    function init(p, v, d)
    end

    # Third, define the run_timestep function for the component
    function run_timestep(p, v, d, t)
    end

end</code></pre><h2 id="Constructing-a-Model-1"><a class="docs-heading-anchor" href="#Constructing-a-Model-1">Constructing a Model</a><a class="docs-heading-anchor-permalink" href="#Constructing-a-Model-1" title="Permalink"></a></h2><p>In an effort to standardize the function naming protocol within Mimi, and to streamline it with the Julia convention, several function names have been changed.  The table below lists a <strong>subset</strong> of these changes, focused on the exported API functions most commonly used in model construction.  </p><table><tr><th style="text-align: right">Old Syntax</th><th style="text-align: center">New Syntax</th></tr><tr><td style="text-align: right"><code>addcomponent!</code></td><td style="text-align: center"><code>add_comp!</code></td></tr><tr><td style="text-align: right"><code>connectparameter</code></td><td style="text-align: center"><code>connect_param!</code></td></tr><tr><td style="text-align: right"><code>setleftoverparameters</code></td><td style="text-align: center"><code>set_leftover_params!</code></td></tr><tr><td style="text-align: right"><code>setparameter</code></td><td style="text-align: center"><code>set_param!</code></td></tr><tr><td style="text-align: right"><code>adddimension</code></td><td style="text-align: center"><code>add_dimension!</code></td></tr><tr><td style="text-align: right"><code>setindex</code></td><td style="text-align: center"><code>set_dimension!</code></td></tr></table><p>Changes to various optional keyword arguments:</p><ul><li><code>add_comp!</code>:  Through Mimi v0.9.4, the optional keyword arguments <code>first</code> and <code>last</code> could be used to specify times for components that do not run for the full length of the model, like this: <code>add_comp!(mymodel, ComponentC; first=2010, last=2100)</code>. This functionality is currently disabled, and all components must run for the full length of the model&#39;s time dimension. This functionality may be re-implemented in a later version of Mimi.</li></ul><h2 id="Running-a-Model-1"><a class="docs-heading-anchor" href="#Running-a-Model-1">Running a Model</a><a class="docs-heading-anchor-permalink" href="#Running-a-Model-1" title="Permalink"></a></h2><h2 id="Accessing-Results-1"><a class="docs-heading-anchor" href="#Accessing-Results-1">Accessing Results</a><a class="docs-heading-anchor-permalink" href="#Accessing-Results-1" title="Permalink"></a></h2><h2 id="Plotting-and-the-Explorer-UI-1"><a class="docs-heading-anchor" href="#Plotting-and-the-Explorer-UI-1">Plotting and the Explorer UI</a><a class="docs-heading-anchor-permalink" href="#Plotting-and-the-Explorer-UI-1" title="Permalink"></a></h2><p>This release of Mimi does not include the plotting functionality previously offered by Mimi.  While the previous files are still included, the functions are not exported as efforts are made to simplify and improve the plotting associated with Mimi.  </p><p>The new version does, however, include a new UI tool that can be used to visualize model results.  This <code>explore</code> function is described in the User Guide under <strong>Advanced Topics</strong>.</p><h2 id="Advanced-Topics-1"><a class="docs-heading-anchor" href="#Advanced-Topics-1">Advanced Topics</a><a class="docs-heading-anchor-permalink" href="#Advanced-Topics-1" title="Permalink"></a></h2><h4 id="Timesteps-and-available-functions-1"><a class="docs-heading-anchor" href="#Timesteps-and-available-functions-1">Timesteps and available functions</a><a class="docs-heading-anchor-permalink" href="#Timesteps-and-available-functions-1" title="Permalink"></a></h4><p>As previously mentioned, some relevant function names have changed.  These changes were made to eliminate ambiguity.  For example, the new naming clarifies that <code>is_last</code> returns whether the timestep is on the last valid period to be run, not whether it has run through that period already.  This check can still be achieved with <code>is_finished</code>, which retains its name and function.  Below is a subset of such changes related to timesteps and available functions.</p><table><tr><th style="text-align: right">Old Syntax</th><th style="text-align: center">New Syntax</th></tr><tr><td style="text-align: right"><code>isstart</code></td><td style="text-align: center"><code>is_first</code></td></tr><tr><td style="text-align: right"><code>isstop</code></td><td style="text-align: center"><code>is_last</code></td></tr></table><p>As mentioned in earlier in this document, the fourth argument in <code>run_timestep</code> is an <code>AbstractTimestep</code> i.e. a <code>FixedTimestep</code> or a <code>VariableTimestep</code> and is a type defined within Mimi in &quot;src/time.jl&quot;.  In this version, the fourth argument (<code>t</code> below) can no longer always be used simply as an <code>Int</code>. Defining the <code>AbstractTimestep</code> object as <code>t</code>, indexing with <code>t</code> is still permitted, but special care must be taken when comparing <code>t</code> with conditionals or using it in arithmatic expressions.  Since differential equations are commonly used as the basis for these models&#39; equations, the most commonly needed change will be changing <code>if t == 1</code> to <code>if is_first(t)</code>.</p><p>The full API:</p><ul><li>you may index into a variable or parameter with <code>[t]</code> or <code>[t +/- x]</code> as usual</li><li>to access the time value of <code>t</code> (currently a year) as a <code>Number</code>, use <code>gettime(t)</code></li><li>useful functions for commonly used conditionals are <code>is_first(t)</code> and <code>is_last(t)</code></li><li>to access the index value of <code>t</code> as a <code>Number</code> representing the position in the time array, use <code>t.t</code>.  Users are encouraged to avoid this access, and instead use the options listed above or a separate counter variable. each time the function gets called.  </li></ul><h4 id="Parameter-connections-between-different-length-components-1"><a class="docs-heading-anchor" href="#Parameter-connections-between-different-length-components-1">Parameter connections between different length components</a><a class="docs-heading-anchor-permalink" href="#Parameter-connections-between-different-length-components-1" title="Permalink"></a></h4><h4 id="More-on-parameter-indices-1"><a class="docs-heading-anchor" href="#More-on-parameter-indices-1">More on parameter indices</a><a class="docs-heading-anchor-permalink" href="#More-on-parameter-indices-1" title="Permalink"></a></h4><h4 id="Updating-an-external-parameter-1"><a class="docs-heading-anchor" href="#Updating-an-external-parameter-1">Updating an external parameter</a><a class="docs-heading-anchor-permalink" href="#Updating-an-external-parameter-1" title="Permalink"></a></h4><p>To update an external parameter, use the functions <code>update_param!</code> and <code>update_params!</code> (previously known as <code>update_external_parameter</code> and <code>update_external_parameters</code>, respectively.)  Their calling signatures are:</p><ul><li><p><code>update_params!(md::ModelDef, parameters::Dict; update_timesteps = false)</code></p></li><li><p><code>update_param!(md::ModelDef, name::Symbol, value; update_timesteps = false)</code></p></li></ul><p>For external parameters with a <code>:time</code> dimension, passing <code>update_timesteps=true</code> indicates that the time <em>keys</em> (i.e., year labels) should also be updated in addition to updating the parameter values.</p><h4 id="Setting-parameters-with-a-dictionary-1"><a class="docs-heading-anchor" href="#Setting-parameters-with-a-dictionary-1">Setting parameters with a dictionary</a><a class="docs-heading-anchor-permalink" href="#Setting-parameters-with-a-dictionary-1" title="Permalink"></a></h4><p>The function <code>set_leftover_params!</code> replaces the function <code>setleftoverparameters</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../howto_6/">« 6 Update Time Dimension</a><a class="docs-footer-nextpage" href="../howto_8/">8 Port to v1.0.0 »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 21 February 2025 21:55">Friday 21 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
