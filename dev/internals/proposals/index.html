<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Not Implemented (Yet) · Mimi.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Mimi.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/tutorial_main/">Tutorials Intro</a></li><li><a class="tocitem" href="../../tutorials/tutorial_1/">1 Install Mimi</a></li><li><a class="tocitem" href="../../tutorials/tutorial_2/">2 Run an Existing Model</a></li><li><a class="tocitem" href="../../tutorials/tutorial_3/">3 Modify an Existing Model</a></li><li><a class="tocitem" href="../../tutorials/tutorial_4/">4 Create a Model</a></li><li><a class="tocitem" href="../../tutorials/tutorial_5/">5 Monte Carlo + Sensitivity Analysis</a></li><li><a class="tocitem" href="../../tutorials/tutorial_6/">6 Create a Model with Composite Components</a></li></ul></li><li><span class="tocitem">How-to Guides</span><ul><li><a class="tocitem" href="../../howto/howto_main/">How-to Guides Intro</a></li><li><a class="tocitem" href="../../howto/howto_1/">1 Construct + Run a Model</a></li><li><a class="tocitem" href="../../howto/howto_2/">2 Explore Results</a></li><li><a class="tocitem" href="../../howto/howto_3/">3 Monte Carlo + SA</a></li><li><a class="tocitem" href="../../howto/howto_4/">4 Timesteps</a></li><li><a class="tocitem" href="../../howto/howto_5/">5 Parameters + Variables</a></li><li><a class="tocitem" href="../../howto/howto_6/">6 Update Time Dimension</a></li><li><a class="tocitem" href="../../howto/howto_7/">7 Port to v0.5.0</a></li><li><a class="tocitem" href="../../howto/howto_8/">8 Port to v1.0.0</a></li><li><a class="tocitem" href="../../howto/howto_9/">9 Port to New Param API</a></li></ul></li><li><span class="tocitem">Advanced How-to Guides</span><ul><li><a class="tocitem" href="../../howto_advanced/howto_adv_main/">Advanced How-to Guides Intro</a></li><li><a class="tocitem" href="../../howto_advanced/howto_adv_buildinit/">Build and Init Functions</a></li><li><a class="tocitem" href="../../howto_advanced/howto_adv_datumrefs/">Using Datum References</a></li></ul></li><li><span class="tocitem">Reference Guides</span><ul><li><a class="tocitem" href="../../ref/ref_main/">Reference Guides Intro</a></li><li><a class="tocitem" href="../../ref/ref_API/">Mimi API</a></li><li><a class="tocitem" href="../../ref/ref_structures_classes_types/">Structures: Classes.jl and Types</a></li><li><a class="tocitem" href="../../ref/ref_structures_definitions/">Structures: Definitions</a></li><li><a class="tocitem" href="../../ref/ref_structures_instances/">Structures: Instances</a></li></ul></li><li><span class="tocitem">Explanations</span><ul><li><a class="tocitem" href="../../explanations/exp_main/">Explanations Intro</a></li><li><a class="tocitem" href="../../explanations/exp_pkgs/">Models as Packages</a></li></ul></li><li><a class="tocitem" href="../../faq/">FAQ</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Not Implemented (Yet)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Not Implemented (Yet)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mimiframework/Mimi.jl/blob/master/docs/src/internals/proposals.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Not-Implemented-(Yet)-1"><a class="docs-heading-anchor" href="#Not-Implemented-(Yet)-1">Not Implemented (Yet)</a><a class="docs-heading-anchor-permalink" href="#Not-Implemented-(Yet)-1" title="Permalink"></a></h1><p>This section describes proposed API and file formats that haven&#39;t been developed yet.</p><h2 id="ModelRunner-1"><a class="docs-heading-anchor" href="#ModelRunner-1">ModelRunner</a><a class="docs-heading-anchor-permalink" href="#ModelRunner-1" title="Permalink"></a></h2><p>There are several types of analyses that require an ensemble of model runs performed over a set of parameter values. These include traditional Monte Carlo simulation, in which random values are drawn from distributions and applied to model parameters, as well as global sensitivity analyses that use prescribed methods for defining trial data (e.g., Sobol sampling), and Markov Chain Monte Carlo, which computes new trial data based on prior model results.</p><p>The abstract type <code>ModelRunner</code> will be used to define a generic API for model runners, including support for parallelization of analyses on multiprocessors and cluster computing systems. The specific sampling and analysis methods required for each subtype of <code>ModelRunner</code> will be defined in the concrete subtype, e.g., <code>SimulationRunner</code>.</p><p>The generic process will look something like this:</p><pre><code class="language-julia">m = ModelDef(...)
r = SimRunner(m)

# Optionally redefine random variables, overriding defaults
setrv!(r, :rvname1, Normal(10, 3))

# Optionally assign an alternative RV or distribution to a model parameter
setparam!(r, :comp1, :param1, :rvname1)
setparam!(r, :comp1, :param2, Uniform(0, 3))

# Adjust what should be saved per model run
@add_results(r, param10, param11[US])
@drop_results(r, param1, param1)

# Run trials 1-5000. Also can specify as a range (e.g., 5001:10000) 
# or vector of trial numbers.
run!(r, 5000)

# Save results to the indicated directory
write(r, dirname)</code></pre><h4 id="Saving-ensemble-results-1"><a class="docs-heading-anchor" href="#Saving-ensemble-results-1">Saving ensemble results</a><a class="docs-heading-anchor-permalink" href="#Saving-ensemble-results-1" title="Permalink"></a></h4><p>Ensemble results will be stored in an object of type <code>EnsembleResult</code>, which is used by all subtypes of <code>ModelRunner</code>. By default, only model outputs tagged for output will be saved in the <code>EnsembleResult</code> instance. Parameters can be identified as &quot;output&quot; parameters in <code>@defsim</code>, and/or directly in a concrete subtype of <code>ModelRunner</code>, in which case default values set in <code>@defsim</code> can be overridden.</p><p>The method <code>write(r::ModelRunner, dirname::String)</code> will save model results to set of CSV files in the named directory. Initially, we will store the data in <a href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">tidy</a> format in which variables are in columns and each row represents an observation. This format is verbose but flexible and commonly used by consumers of data such as plotting packages. Other formats can be generated if the need arises.</p><p>In the initial implementation, results will be saved as follows:</p><ul><li><p>Scalar model results will be written to <code>&quot;$dirname/scalars.csv&quot;</code>. The file will have a column holding the trial number, and one column labeled with each parameter name. Each row in the file will contain all scalar parameter values data for a single  model run. </p><ul><li><p>Example:</p><table><tr><th style="text-align: right">trialnum</th><th style="text-align: right">foo</th><th style="text-align: right">bar</th><th style="text-align: right">baz</th><th style="text-align: right">...</th></tr><tr><td style="text-align: right">1</td><td style="text-align: right">1.6</td><td style="text-align: right">0.4</td><td style="text-align: right">110</td><td style="text-align: right">...</td></tr></table></li><li><p>Alternatively, we could flatten to 3 columns: </p><table><tr><th style="text-align: right">trialnum</th><th style="text-align: right">paramname</th><th style="text-align: right">value</th></tr><tr><td style="text-align: right">1</td><td style="text-align: right">foo</td><td style="text-align: right">1.6</td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">bar</td><td style="text-align: right">0.4</td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">baz</td><td style="text-align: right">110</td></tr></table></li></ul></li><li><p>All model results with a single time dimension will be written to <code>&quot;$dirname/timeseries.csv&quot;</code>, with columns:</p><table><tr><th style="text-align: right">trialnum</th><th style="text-align: right">year</th><th style="text-align: right">foo</th><th style="text-align: right">bar</th><th style="text-align: right">baz</th><th style="text-align: right">...</th></tr><tr><td style="text-align: right">1</td><td style="text-align: right">2010</td><td style="text-align: right">100.6</td><td style="text-align: right">41.6</td><td style="text-align: right">9.1</td><td style="text-align: right">...</td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">2015</td><td style="text-align: right">101.7</td><td style="text-align: right">44.5</td><td style="text-align: right">10.2</td><td style="text-align: right">...</td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">2020</td><td style="text-align: right">102.8</td><td style="text-align: right">50.1</td><td style="text-align: right">12.4</td><td style="text-align: right">...</td></tr><tr><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">2010</td><td style="text-align: right">101.6</td><td style="text-align: right">43.7</td><td style="text-align: right">10.4</td><td style="text-align: right">...</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">2015</td><td style="text-align: right">102.4</td><td style="text-align: right">60.1</td><td style="text-align: right">21.3</td><td style="text-align: right">...</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">2020</td><td style="text-align: right">105.7</td><td style="text-align: right">55.3</td><td style="text-align: right">14.2</td><td style="text-align: right">...</td></tr><tr><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td></tr></table><ul><li><p>As with scalar results, this might be flattened further to:</p><table><tr><th style="text-align: right">trialnum</th><th style="text-align: right">paramname</th><th style="text-align: right">year</th><th style="text-align: right">value</th></tr><tr><td style="text-align: right">1</td><td style="text-align: right">foo</td><td style="text-align: right">2010</td><td style="text-align: right">100.6</td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">foo</td><td style="text-align: right">2015</td><td style="text-align: right">101.7</td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">foo</td><td style="text-align: right">2020</td><td style="text-align: right">102.8</td></tr><tr><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">foo</td><td style="text-align: right">2010</td><td style="text-align: right">101.6</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">foo</td><td style="text-align: right">2015</td><td style="text-align: right">102.4</td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">foo</td><td style="text-align: right">2020</td><td style="text-align: right">105.7</td></tr><tr><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td><td style="text-align: right">...</td></tr></table></li><li><p>Another alternative would be to store each timeseries result to its own CSV file, in which case the second (flattened) format would be used, minus the &quot;paramname&quot; column, which would be implicit from the filename. This would be more consistent with the matrix format below, since a timeseries result is just a matrix result with only one dimension.</p></li></ul></li><li><p>Matrix results will be saved to individual files named <code>&quot;$dirname/$paramname.csv&quot;</code>. Matrices will be flattened so that each dimension appears as a column. For example, a matrix with dimensions &quot;time&quot; and &quot;region&quot; will have columns &quot;trialnum&quot;, </p><table><tr><th style="text-align: right">trialnum</th><th style="text-align: right">region</th><th style="text-align: right">year</th><th style="text-align: right">value</th></tr><tr><td style="text-align: right">1</td><td style="text-align: right">US</td><td style="text-align: right">2010</td><td style="text-align: right">1.1</td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">US</td><td style="text-align: right">2015</td><td style="text-align: right">1.9</td></tr><tr><td style="text-align: right">...</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">CHI</td><td style="text-align: right">2010</td><td style="text-align: right">0.2</td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">CHI</td><td style="text-align: right">2015</td><td style="text-align: right">0.8</td></tr><tr><td style="text-align: right">...</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr></table></li><li><p>Another option for saving ensemble outputs might include writing to any &quot;sink&quot; type that accepts named tuples.</p></li></ul><h2 id="Model-result-file-format-1"><a class="docs-heading-anchor" href="#Model-result-file-format-1">Model result file format</a><a class="docs-heading-anchor-permalink" href="#Model-result-file-format-1" title="Permalink"></a></h2><p>To facilitate post-processing, model results will be saved to files in either JSON formats, as detailed below. To save results, the following methods can be used.</p><p>For individual model runs, results can be saved to a single file, or added to an existing file. For SA simulations, a single JSON file will hold the subset  of results specified by the user, for each trial. This may become unwieldy, but we support gzipped JSON, which helps a bit: if a filename ends in  <code>.gz</code>, it will automatically be zipped on writing and gzipped on reading.</p><pre><code class="language-julia">saveresults(m::Model, pathname::String)

saveresults(m::Model, pathname::String, append=true)

saveresults(sim:Simulation, pathname::String)</code></pre><h4 id="JSON-file-format-1"><a class="docs-heading-anchor" href="#JSON-file-format-1">JSON file format</a><a class="docs-heading-anchor-permalink" href="#JSON-file-format-1" title="Permalink"></a></h4><p>The JSON file format is basically a set of nested dictionaries, with a few lists at the innermost levels. We assign names to these levels for clarity of exposition in this documentation, but these names do not exist in the actual files.</p><p>We specify <code>dicttype=DataStructures.OrderedDict</code> when reading and writing JSON files to ensure that insertion order is maintained.</p><h4 id="Scenario-dict-1"><a class="docs-heading-anchor" href="#Scenario-dict-1">Scenario dict</a><a class="docs-heading-anchor-permalink" href="#Scenario-dict-1" title="Permalink"></a></h4><p>The top level of the JSON file is a dictionary keyed by scenario name (for non-SA results) or trial number (basically a numeric scenario name) for SA results.</p><h4 id="Index-Variable-Parameter-(IVP)-dict-1"><a class="docs-heading-anchor" href="#Index-Variable-Parameter-(IVP)-dict-1">Index-Variable-Parameter (IVP) dict</a><a class="docs-heading-anchor-permalink" href="#Index-Variable-Parameter-(IVP)-dict-1" title="Permalink"></a></h4><p>The value of the top-level dictionary is a dictionary whose keys are types of model inputs and results, which is currently one of <code>&quot;Index&quot;</code>, <code>&quot;Variable&quot;</code>, or <code>&quot;Parameter&quot;</code> of these dictionaries vary by the type of object stored, as shown below.</p><h4 id="Index-dict-1"><a class="docs-heading-anchor" href="#Index-dict-1">Index dict</a><a class="docs-heading-anchor-permalink" href="#Index-dict-1" title="Permalink"></a></h4><p>An index dict is keyed by index name (e.g., <code>&quot;time&quot;</code>, <code>&quot;region&quot;</code>) with values being lists of index values. For example the <code>&quot;time&quot;</code> index might look like this:</p><p><code>&quot;time&quot; : [2010, 2011, 2012, 2013, ..., 2099, 2100]</code></p><p>These are converted to <code>Index</code> objects upon reading.</p><h4 id="Variable-dict-1"><a class="docs-heading-anchor" href="#Variable-dict-1">Variable dict</a><a class="docs-heading-anchor-permalink" href="#Variable-dict-1" title="Permalink"></a></h4><p>Variable dicts are keyed by a string of the form <code>&quot;$component_name:$variable_name&quot;</code> (tuple keys are not supported in JSON). Values are single numerical values for scalar parameters, or for vector and matrix values, a list of lists of the form <code>[[dimensions...], [values...]]</code> where <code>dimensions</code>. Examples:</p><pre><code class="language-julia">{
 # Scalar
 &quot;foo&quot; : 42,

 # one dimension
 &quot;bar&quot; : [[&quot;region&quot;], [4.1, 7.2, 3.6, 9.4, 5.5, 7.6, ...],

 # two dimensions are stored as arrays of arrays
 &quot;baz&quot; : [
   [&quot;time&quot;, &quot;region&quot;], 
   [[4.1, 7.2, 3.6, ...], # values by region for first timestep
    [3.5, 6.3, 5.6, ...], # values by region for 2nd timestep
    ...]
  ]
}</code></pre><h4 id="Parameter-dict-1"><a class="docs-heading-anchor" href="#Parameter-dict-1">Parameter dict</a><a class="docs-heading-anchor-permalink" href="#Parameter-dict-1" title="Permalink"></a></h4><p>Parameter dicts are keyed by model parameter names (symbols), with values represented in the same format as shown above for Variable dicts.</p></article></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 22 November 2024 22:47">Friday 22 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
